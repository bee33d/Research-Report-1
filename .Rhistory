culture <- read.csv("cultures.csv")
library(dplyr)
scenario_data <- df %>%
group_by(ResponseID, UserID, ScenarioTypeStrict,UserCountry3) %>%
filter(sum(Saved == 1, na.rm = TRUE) == 1) %>%  # exactly one chosen
summarise(
chosen_attribute = AttributeLevel[Saved == 1][1],
.groups = "drop"
)
majority_map <- tibble::tibble(
ScenarioTypeStrict = c("Age", "Utilitarian", "Species", "Fitness"),
majority_attribute = c("Young", "More", "Hoomans", "Fit")
)
majority_map
scenario_flagged <- scenario_data %>%
inner_join(majority_map, by = "ScenarioTypeStrict") %>%
mutate(
against_majority = as.numeric(chosen_attribute != majority_attribute)
)
against_majority_data <- scenario_flagged %>%
filter(against_majority)
scenario_flagged <- scenario_data %>%
inner_join(majority_map, by = "ScenarioTypeStrict") %>%
mutate(
against_majority = as.numeric(chosen_attribute != majority_attribute)
)
against_majority_data <- scenario_flagged %>%
filter(against_majority == 1)
scenario_flagged
View(scenario_data)
View(scenario_flagged)
country_summary <- scenario_flagged %>%
group_by(UserCountry3) %>%
summarise(
n = n(),
prop_against = mean(against_majority, na.rm = TRUE)
) %>%
filter(n >= 200)   # stability threshold
head(arrange(country_summary, desc(prop_against)), 10)
head(arrange(country_summary, prop_against), 10)
individual_consistency <- scenario_flagged %>%
group_by(UserID) %>%
summarise(
n = n(),
prop_against = mean(against_majority, na.rm = TRUE), .groups = "drop"
) %>%
filter(n >= 2)
View(individual_consistency)
summary(individual_consistency$prop_against)
df <- readRDS("fullRsample.rds")
culture <- read.csv("cultures.csv")
library(dplyr)
scenario_data <- df %>%
group_by(ResponseID, UserID, ScenarioTypeStrict,UserCountry3) %>%
filter(sum(Saved == 1, na.rm = TRUE) == 1) %>%  # exactly one chosen
summarise(
chosen_attribute = AttributeLevel[Saved == 1][1],
.groups = "drop"
)
majority_map <- tibble::tibble(
ScenarioTypeStrict = c("Age", "Utilitarian", "Species", "Fitness"),
majority_attribute = c("Young", "More", "Hoomans", "Fit")
)
majority_map
scenario_flagged <- scenario_data %>%
inner_join(majority_map, by = "ScenarioTypeStrict") %>%
mutate(
against_majority = as.numeric(chosen_attribute != majority_attribute)
)
against_majority_data <- scenario_flagged %>%
filter(against_majority == 1)
scenario_flagged
table(scenario_flagged$ScenarioTypeStrict)
prop.table(table(scenario_flagged$against_majority))
country_summary <- scenario_flagged %>%
group_by(UserCountry3) %>%
summarise(
n = n(),
prop_against = mean(against_majority, na.rm = TRUE)
) %>%
filter(n >= 200)   # stability threshold
head(arrange(country_summary, desc(prop_against)), 10)
head(arrange(country_summary, prop_against), 10)
individual_against <- scenario_flagged %>%
group_by(UserID) %>%
summarise(
n = n(),
prop_against = mean(against_majority, na.rm = TRUE), .groups = "drop"
) %>%
filter(n >= 2)
summary(individual_against$prop_against)
View(country_summary)
scenario_flagged %>%
group_by(UserCountry3, ScenarioTypeStrict) %>%
summarise(
prop_against = mean(against_majority),
n = n(),
.groups = "drop"
) %>%
filter(n >= 100)
chisq.test(
table(scenario_flagged$ScenarioTypeStrict,
scenario_flagged$against_majority)
)
country_summary <- country_summary %>%
left_join(culture, by = c("UserCountry3" = "countries"))
category_summary <- country_summary %>%
group_by(categories) %>%
summarise(
n_countries = n(),
mean_against = mean(prop_against, na.rm = TRUE),
median_against = median(prop_against, na.rm = TRUE),
iqr_against = IQR(prop_against, na.rm = TRUE),
.groups = "drop"
)
View(category_summary)
df <- readRDS("fullRsample.rds")
culture <- read.csv("cultures.csv")
library(dplyr)
scenario_data <- df %>%
group_by(ResponseID, UserID, ScenarioTypeStrict,UserCountry3) %>%
filter(sum(Saved == 1, na.rm = TRUE) == 1) %>%  # exactly one chosen
summarise(
chosen_attribute = AttributeLevel[Saved == 1][1],
.groups = "drop"
)
majority_map <- tibble::tibble(
ScenarioTypeStrict = c("Age", "Utilitarian", "Species", "Fitness"),
majority_attribute = c("Young", "More", "Hoomans", "Fit")
)
majority_map
scenario_flagged <- scenario_data %>%
inner_join(majority_map, by = "ScenarioTypeStrict") %>%
mutate(
against_majority = as.numeric(chosen_attribute != majority_attribute)
)
against_majority_data <- scenario_flagged %>%
filter(against_majority == 1)
scenario_flagged
table(scenario_flagged$ScenarioTypeStrict)
prop.table(table(scenario_flagged$against_majority))
scenario_flagged %>%
group_by(ScenarioTypeStrict) %>%
summarise(
n = n(),
prop_against = mean(against_majority, na.rm = TRUE)
) %>%
arrange(desc(prop_against))
country_summary <- scenario_flagged %>%
group_by(UserCountry3) %>%
summarise(
n = n(),
prop_against = mean(against_majority, na.rm = TRUE),
.groups = "drop"
) %>%
filter(n >= 200) %>%
left_join(culture, by = c("UserCountry3" = "countries"))
# stability threshold
library(ggplot2)
library(scales)
ggplot(country_summary, aes(x = prop_against)) +
geom_histogram(bins = 20, fill = "#2C7FB8", color = "white") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
labs(x = "Proportion against majority", y = "Number of countries") +
theme_minimal()
ggplot(country_summary, aes(x = reorder(categories, categories, function(x) -length(x)))) +
geom_bar(fill = "#41AE76") +
labs(x = "Cultural category", y = "Number of countries") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(country_summary, aes(x = reorder(categories, prop_against, median, na.rm = TRUE), y = prop_against)) +
geom_boxplot(fill = "#FDAE6B", alpha = 0.8, outlier.alpha = 0.4) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
labs(x = "Cultural category", y = "Proportion against majority") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
scenario_desc <- scenario_flagged %>%
group_by(ScenarioTypeStrict) %>%
summarise(
n = n(),
prop_against = mean(against_majority, na.rm = TRUE),
divisiveness_index = 1 - 2 * abs(prop_against - 0.5), # 1 = most divisive, 0 = strongest consensus
.groups = "drop"
) %>%
arrange(desc(divisiveness_index))
knitr::kable(scenario_desc, digits = 3, caption = "H1 descriptive: divisiveness by scenario type")
tab_h1 <- table(scenario_flagged$ScenarioTypeStrict, scenario_flagged$against_majority)
chisq_h1 <- chisq.test(tab_h1)
h1_test <- tibble::tibble(
statistic = as.numeric(chisq_h1$statistic),
df = as.numeric(chisq_h1$parameter),
p_value = chisq_h1$p.value,
cramer_v = sqrt(as.numeric(chisq_h1$statistic) / (sum(tab_h1) * (min(dim(tab_h1)) - 1)))
)
knitr::kable(h1_test, digits = 4, caption = "H1 inferential test: chi-square (Scenario Type × Against Majority)")
tab_h1 <- table(scenario_flagged$ScenarioTypeStrict, scenario_flagged$against_majority)
chisq_h1 <- chisq.test(tab_h1)
h1_test <- tibble::tibble(
statistic = as.numeric(chisq_h1$statistic),
df = as.numeric(chisq_h1$parameter),
p_value_raw = chisq_h1$p.value,
p_value_display = format(chisq_h1$p.value, scientific = TRUE),
cramer_v = sqrt(as.numeric(chisq_h1$statistic) / (sum(tab_h1) * (min(dim(tab_h1)) - 1)))
)
knitr::kable(h1_test, digits = 4, caption = "H1 inferential test: chi-square (Scenario Type × Against Majority)")
country_data <- scenario_flagged %>%
group_by(UserCountry3, cultural_context) %>%
summarise(
n = n(),
prop_against = mean(against_majority, na.rm = TRUE),
.groups = "drop"
) %>%
filter(n >= 200)
df <- readRDS("fullRsample.rds")
setwd("/Volumes/TOSHIBA 1TO/Research-Report-1")
df <- readRDS("fullRsample.rds")
df <- readRDS("fullRsample.rds")
setwd("~/Documents/GitHub/Research-Report-1")
culture <- read.csv("cultures.csv")
majority_map <- tibble::tibble(
ScenarioTypeStrict = c("Age", "Utilitarian", "Species", "Fitness"),
majority_attribute = c("Young", "More", "Hoomans", "Fit")
)
majority_map
library(dplyr)
scenario_data <- df %>%
group_by(ResponseID, UserID, ScenarioTypeStrict,UserCountry3) %>%
filter(sum(Saved == 1, na.rm = TRUE) == 1) %>%  # exactly one chosen
summarise(
chosen_attribute = AttributeLevel[Saved == 1][1],
.groups = "drop"
)
View(scenario_data)
scenario_flagged <- scenario_data %>%
inner_join(majority_map, by = "ScenarioTypeStrict") %>%
mutate(against_majority = as.integer(chosen_attribute != majority_attribute)) %>%
left_join(culture, by = c("UserCountry3" = "countries")) %>%
rename(cultural_context = categories) %>%
filter(!is.na(cultural_context), !is.na(ScenarioTypeStrict), !is.na(against_majority))
View(scenario_flagged)
scenario_desc <- scenario_flagged %>%
group_by(ScenarioTypeStrict) %>%
summarise(
n = n(),
prop_against = mean(against_majority, na.rm = TRUE),
divisiveness_index = 1 - 2 * abs(prop_against - 0.5), # 1 = most divisive, 0 = strongest consensus
.groups = "drop"
) %>%
arrange(desc(divisiveness_index))
knitr::kable(scenario_desc, digits = 3, caption = "H1 descriptive: divisiveness by scenario type")
tab_h1 <- table(scenario_flagged$ScenarioTypeStrict, scenario_flagged$against_majority)
chisq_h1 <- chisq.test(tab_h1)
tab_h1 <- table(scenario_flagged$ScenarioTypeStrict, scenario_flagged$against_majority)
chisq_h1 <- chisq.test(tab_h1)
h1_test <- tibble::tibble(
statistic = as.numeric(chisq_h1$statistic),
df = as.numeric(chisq_h1$parameter),
p_value_raw = chisq_h1$p.value,
p_value_display = format(chisq_h1$p.value, scientific = TRUE),
cramer_v = sqrt(as.numeric(chisq_h1$statistic) / (sum(tab_h1) * (min(dim(tab_h1)) - 1)))
)
knitr::kable(h1_test, digits = 4, caption = "H1 inferential test: chi-square (Scenario Type × Against Majority)")
country_data <- scenario_flagged %>%
group_by(UserCountry3, cultural_context) %>%
summarise(
n = n(),
prop_against = mean(against_majority, na.rm = TRUE),
.groups = "drop"
) %>%
filter(n >= 200)
fit_h2 <- aov(prop_against ~ cultural_context, data = country_data, weights = n)
h2_anova <- broom::tidy(fit_h2)
knitr::kable(h2_anova, digits = 4, caption = "H2 inferential test: ANOVA of deviation by cultural context")
fit_h3 <- lm(prop_against ~ cultural_context * ScenarioTypeStrict, data = cell_data, weights = n)
cell_data <- scenario_flagged %>%
group_by(UserCountry3, cultural_context, ScenarioTypeStrict) %>%
summarise(
n = n(),
prop_against = mean(against_majority, na.rm = TRUE),
.groups = "drop"
) %>%
filter(n >= 100)
fit_h3 <- lm(prop_against ~ cultural_context * ScenarioTypeStrict, data = cell_data, weights = n)
anova(fit_h3)  # ANOVA table including interaction term
h3_interaction_test <- broom::tidy(anova(fit_h3_add, fit_h3_int))
fit_h3_add <- lm(prop_against ~ cultural_context + ScenarioTypeStrict, data = cell_data, weights = n)
fit_h3_int <- lm(prop_against ~ cultural_context * ScenarioTypeStrict, data = cell_data, weights = n)
h3_anova_terms <- broom::tidy(anova(fit_h3_int))
h3_interaction_test <- broom::tidy(anova(fit_h3_add, fit_h3_int))
knitr::kable(h3_anova_terms, digits = 4, caption = "H3 full model ANOVA table (includes interaction term)")
knitr::kable(h3_interaction_test, digits = 4, caption = "H3 model comparison: does adding interaction improve fit?")
tab_h1 <- table(scenario_flagged$ScenarioTypeStrict, scenario_flagged$against_majority)
chisq_h1 <- chisq.test(tab_h1)
h1_test <- tibble::tibble(
statistic = as.numeric(chisq_h1$statistic),
df = as.numeric(chisq_h1$parameter),
p_value_raw = chisq_h1$p.value,
p_value_display = format(chisq_h1$p.value, scientific = TRUE),
cramer_v = sqrt(as.numeric(chisq_h1$statistic) / (sum(tab_h1) * (min(dim(tab_h1)) - 1)))
)
h1_table <- as.data.frame.matrix(tab_h1)
h1_table <- tibble::rownames_to_column(h1_table, var = "ScenarioTypeStrict")
knitr::kable(h1_table, caption = "H1 contingency table: Scenario Type × Against Majority")
knitr::kable(h1_test, digits = 4, caption = "H1 inferential test: chi-square (Scenario Type × Against Majority)")
fit_h2 <- lm(prop_against ~ cultural_context, data = country_data, weights = n)
h2_coefs <- broom::tidy(fit_h2, conf.int = TRUE)
h2_glance <- broom::glance(fit_h2) %>%
transmute(
r_squared = r.squared,
adj_r_squared = adj.r.squared,
sigma = sigma,
statistic_F = statistic,
p_value_model = p.value,
df_model = df,
n_obs = nobs
)
knitr::kable(h2_coefs, digits = 4, caption = "H2 linear model coefficients")
knitr::kable(h2_glance, digits = 4, caption = "H2 model fit summary")
fit_h3_add <- lm(prop_against ~ cultural_context + ScenarioTypeStrict, data = cell_data, weights = n)
fit_h3_int <- lm(prop_against ~ cultural_context * ScenarioTypeStrict, data = cell_data, weights = n)
h3_coefs <- broom::tidy(fit_h3_int, conf.int = TRUE)
h3_anova_compare <- broom::tidy(anova(fit_h3_add, fit_h3_int))
h3_glance <- broom::glance(fit_h3_int) %>%
transmute(
r_squared = r.squared,
adj_r_squared = adj.r.squared,
sigma = sigma,
statistic_F = statistic,
p_value_model = p.value,
df_model = df,
n_obs = nobs
)
knitr::kable(h3_coefs, digits = 4, caption = "H3 interaction model coefficients")
knitr::kable(h3_anova_compare, digits = 4, caption = "H3 ANOVA model comparison (additive vs interaction)")
knitr::kable(h3_glance, digits = 4, caption = "H3 interaction model fit summary")
library(ggplot2)
library(scales)
ggplot(country_data, aes(x = reorder(cultural_context, prop_against, median), y = prop_against)) +
geom_boxplot(fill = "#41AE76", alpha = 0.85, outlier.alpha = 0.35) +
stat_summary(fun = mean, geom = "point", color = "black", size = 2) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
labs(
title = "H2: Deviation from majority by cultural context",
x = "Cultural context",
y = "Proportion against majority"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(cell_data, aes(x = ScenarioTypeStrict, y = prop_against, color = cultural_context, group = cultural_context)) +
stat_summary(fun = mean, geom = "line", linewidth = 0.8, alpha = 0.8) +
stat_summary(fun = mean, geom = "point", size = 2, alpha = 0.9) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
labs(
title = "H3: Interaction between cultural context and scenario type",
x = "Scenario type",
y = "Proportion against majority",
color = "Cultural context"
) +
theme_minimal()
ggplot(cell_data, aes(x = ScenarioTypeStrict, y = prop_against)) +
geom_boxplot(fill = "#9ECAE1", alpha = 0.8, outlier.alpha = 0.25) +
facet_wrap(~ cultural_context) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
labs(
title = "H3: Scenario-type differences within each cultural context",
x = "Scenario type",
y = "Proportion against majority"
) +
theme_minimal()
scenario_desc <- scenario_flagged %>%
group_by(ScenarioTypeStrict) %>%
summarise(
n = n(),
prop_against = mean(against_majority, na.rm = TRUE),
divisiveness_index = 1 - 2 * abs(prop_against - 0.5), # 1=most divisive, 0=most consensual
.groups = "drop"
) %>%
arrange(desc(divisiveness_index))
ggplot(scenario_desc, aes(x = ScenarioTypeStrict, y = prop_against, fill = ScenarioTypeStrict)) +
geom_col(show.legend = FALSE) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
labs(x = "Scenario type", y = "Proportion against majority") +
theme_minimal()
knitr::kable(scenario_desc, digits = 3, caption = "Scenario-type descriptives")
ggplot(scenario_desc, aes(x = ScenarioTypeStrict, y = prop_against, fill = ScenarioTypeStrict)) +
geom_col(show.legend = FALSE) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
labs(x = "Scenario type", y = "Proportion against majority") +
theme_minimal()
country_data <- scenario_flagged %>%
group_by(UserCountry3, cultural_context) %>%
summarise(
n = n(),
prop_against = mean(against_majority, na.rm = TRUE),
.groups = "drop"
) %>%
filter(n >= 200)
culture_desc <- country_data %>%
group_by(cultural_context) %>%
summarise(
n_countries = n(),
mean_prop_against = mean(prop_against, na.rm = TRUE),
sd_prop_against = sd(prop_against, na.rm = TRUE),
.groups = "drop"
) %>%
arrange(desc(mean_prop_against))
knitr::kable(culture_desc, digits = 3, caption = "Cultural-context descriptives")
scenario_flagged <- scenario_flagged %>%
mutate(
cultural_context = trimws(cultural_context),
cultural_context = na_if(cultural_context, ""),
cultural_context = na_if(cultural_context, "NA"),
cultural_context = na_if(cultural_context, "N/A")
) %>%
filter(!is.na(cultural_context))
scenario_desc <- scenario_flagged %>%
group_by(ScenarioTypeStrict) %>%
summarise(
n = n(),
prop_against = mean(against_majority, na.rm = TRUE),
divisiveness_index = 1 - 2 * abs(prop_against - 0.5), # 1=most divisive, 0=most consensual
.groups = "drop"
) %>%
arrange(desc(divisiveness_index))
knitr::kable(scenario_desc, digits = 3, caption = "Scenario-type descriptives")
ggplot(scenario_desc, aes(x = ScenarioTypeStrict, y = prop_against, fill = ScenarioTypeStrict)) +
geom_col(show.legend = FALSE) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
labs(x = "Scenario type", y = "Proportion against majority") +
theme_minimal()
country_data <- scenario_flagged %>%
group_by(UserCountry3, cultural_context) %>%
summarise(
n = n(),
prop_against = mean(against_majority, na.rm = TRUE),
.groups = "drop"
) %>%
filter(n >= 200)
culture_desc <- country_data %>%
group_by(cultural_context) %>%
summarise(
n_countries = n(),
mean_prop_against = mean(prop_against, na.rm = TRUE),
sd_prop_against = sd(prop_against, na.rm = TRUE),
.groups = "drop"
) %>%
arrange(desc(mean_prop_against))
knitr::kable(culture_desc, digits = 3, caption = "Cultural-context descriptives")
ggplot(country_data, aes(x = reorder(cultural_context, prop_against, median), y = prop_against)) +
geom_boxplot(fill = "#41AE76", alpha = 0.85, outlier.alpha = 0.35) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
labs(x = "Cultural context", y = "Proportion against majority") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(ggplot2)
library(scales)
ggplot(country_data, aes(x = reorder(cultural_context, prop_against, median), y = prop_against)) +
geom_boxplot(fill = "#41AE76", alpha = 0.85, outlier.alpha = 0.35) +
stat_summary(fun = mean, geom = "point", color = "black", size = 2) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
labs(
title = "H2: Deviation from majority by cultural context",
x = "Cultural context",
y = "Proportion against majority"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(cell_data, aes(x = ScenarioTypeStrict, y = prop_against, color = cultural_context, group = cultural_context)) +
stat_summary(fun = mean, geom = "line", linewidth = 0.8, alpha = 0.8) +
stat_summary(fun = mean, geom = "point", size = 2, alpha = 0.9) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
labs(
title = "H3: Interaction between cultural context and scenario type",
x = "Scenario type",
y = "Proportion against majority",
color = "Cultural context"
) +
theme_minimal()
ggplot(cell_data, aes(x = ScenarioTypeStrict, y = prop_against, color = cultural_context, group = cultural_context)) +
stat_summary(fun = mean, geom = "line", linewidth = 0.8, alpha = 0.8) +
stat_summary(fun = mean, geom = "point", size = 2, alpha = 0.9) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
labs(
title = "H3: Interaction between cultural context and scenario type",
x = "Scenario type",
y = "Proportion against majority",
color = "Cultural context"
) +
theme_minimal()
library(ggplot2)
ggplot(cell_data, aes(x = ScenarioTypeStrict, y = prop_against, color = cultural_context, group = cultural_context)) +
stat_summary(fun = mean, geom = "line", linewidth = 0.8, alpha = 0.8) +
stat_summary(fun = mean, geom = "point", size = 2, alpha = 0.9) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
labs(
title = "H3: Interaction between cultural context and scenario type",
x = "Scenario type",
y = "Proportion against majority",
color = "Cultural context"
) +
theme_minimal()
library(ggplot2)
library(scales)
ggplot(scenario_desc, aes(x = ScenarioTypeStrict, y = prop_against, fill = ScenarioTypeStrict)) +
geom_col(show.legend = FALSE) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
labs(
title = "H1: Deviation from global majority preferences across scenario types",
x = "Scenario type",
y = "Proportion against majority"
) +
theme_minimal()
