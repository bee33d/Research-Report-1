demo()
clear
library(tidyverse)
for (pkg in c("tidyverse", "haven", "labelled")) if (!requireNamespace(pkg, quietly = TRUE)) install.packages(pkg)
sample (1:6,1)
sample (1:10,4)
?sample
?sample
rep(4,7)
3+5
df <- readRDS("fullRsample.rds")
setwd("/Volumes/TOSHIBA 1TO/Research-Report-1")
df <- readRDS("fullRsample.rds")
fullRsample <- readRDS("/Volumes/TOSHIBA 1TO/Research-Report-1/fullRsample.rds")
culture <- read.csv("cultures.csv")
View(culture)
df <- readRDS("fullRsample.rds")
df_sample <- readRDS("df_sample.rds")
df_sample %>%
count(ResponseID, UserID) %>%
count(n) %>%
print(n = 50)
View(df_sample)
df_sample_v2 <- readRDS("/Volumes/TOSHIBA 1TO/Research-Report-1/df_sample_v2.rds")
df_sample <- readRDS("df_sample.rds")
library(dplyr)
df_sample %>%
count(ResponseID, UserID) %>%
count(n) %>%
print(n = 50)
df_sample %>%
count(ResponseID, UserID) %>%
count(n) %>%
print(n = 50)
library(dplyr)
scenario_data <- df_sample %>%
group_by(ResponseID, UserID, ScenarioTypeStrict,UserCountry3) %>%
filter(sum(Saved == 1, na.rm = TRUE) == 1) %>%  # exactly one chosen
summarise(
chosen_attribute = AttributeLevel[Saved == 1][1],
.groups = "drop"
)
majority_map <- tibble::tibble(
ScenarioTypeStrict = c("Age", "Utilitarian", "Species", "Fitness"),
majority_attribute = c("Young", "More", "Hoomans", "Fit")
)
majority_map
saveRDS(df_sample, "fullRsample.rds")
majority_map <- tibble::tibble(
ScenarioTypeStrict = c("Age", "Utilitarian", "Species", "Fitness"),
majority_attribute = c("Young", "More", "Hoomans", "Fit")
)
majority_map
scenario_flagged <- scenario_data %>%
inner_join(majority_map, by = "ScenarioTypeStrict") %>%
mutate(
against_majority = chosen_attribute != majority_attribute
)
against_majority_data <- scenario_flagged %>%
filter(against_majority)
scenario_flagged
table(scenario_flagged$ScenarioTypeStrict)
prop.table(table(scenario_flagged$against_majority))
scenario_flagged %>%
group_by(ScenarioTypeStrict) %>%
summarise(
n = n(),
prop_against = mean(against_majority, na.rm = TRUE)
) %>%
arrange(desc(prop_against))
country_summary <- scenario_flagged %>%
group_by(UserCountry3) %>%
summarise(
n = n(),
prop_against = mean(against_majority, na.rm = TRUE)
) %>%
filter(n >= 200)   # stability threshold
head(arrange(country_summary, desc(prop_against)), 10)
head(arrange(country_summary, prop_against), 10)
individual_consistency <- scenario_flagged %>%
group_by(UserID) %>%
summarise(
n = n(),
prop_against = mean(against_majority, na.rm = TRUE), .groups = "drop"
) %>%
filter(n >= 2)
summary(individual_consistency$prop_against)
scenario_flagged %>%
group_by(UserCountry3, ScenarioTypeStrict) %>%
summarise(
prop_against = mean(against_majority),
n = n(),
.groups = "drop"
) %>%
filter(n >= 100)
chisq.test(
table(scenario_flagged$ScenarioTypeStrict,
scenario_flagged$against_majority)
)
scenario_flagged <- scenario_flagged %>%
left_join(culture, by = c("UserCountry3"="countries"))
country_summary %>%
group_by(scenario_flagged$categories) %>%
summarise(
n = n(),
mean_against = mean(prop_against, na.rm = TRUE),
sd_against = sd(prop_against, na.rm = TRUE),
median_against = median(prop_against, na.rm = TRUE),
iqr_against = IQR(prop_against, na.rm = TRUE),
.groups = "drop"
)
country_summary %>%
group_by(scenario_flagged$categories) %>%
summarise(
n = n(),
mean_against = mean(prop_against, na.rm = TRUE),
sd_against = sd(prop_against, na.rm = TRUE),
median_against = median(prop_against, na.rm = TRUE),
iqr_against = IQR(prop_against, na.rm = TRUE),
.groups = "drop"
)
rlang::last_trace()
View(scenario_flagged)
country_summary %>%
group_by(categories) %>%
summarise(
n = n(),
mean_against = mean(prop_against, na.rm = TRUE),
sd_against = sd(prop_against, na.rm = TRUE),
median_against = median(prop_against, na.rm = TRUE),
iqr_against = IQR(prop_against, na.rm = TRUE),
.groups = "drop"
)
country_summary %>%
group_by(scenario_flagged$categories) %>%
summarise(
n = n(),
mean_against = mean(prop_against, na.rm = TRUE),
sd_against = sd(prop_against, na.rm = TRUE),
median_against = median(prop_against, na.rm = TRUE),
iqr_against = IQR(prop_against, na.rm = TRUE),
.groups = "drop"
)
country_summary %>%
left_join(
scenario_flagged %>% select(country, categories),
by = "country"
) %>%
group_by(categories) %>%
summarise(
n = n(),
mean_against = mean(prop_against, na.rm = TRUE),
sd_against = sd(prop_against, na.rm = TRUE),
median_against = median(prop_against, na.rm = TRUE),
iqr_against = IQR(prop_against, na.rm = TRUE),
.groups = "drop"
)
View(country_summary)
View(scenario_flagged)
country_summary %>%
left_join(
scenario_flagged %>% select(countries, categories),
by = "countries"
) %>%
group_by(categories) %>%
summarise(
n = n(),
mean_against = mean(prop_against, na.rm = TRUE),
sd_against = sd(prop_against, na.rm = TRUE),
median_against = median(prop_against, na.rm = TRUE),
iqr_against = IQR(prop_against, na.rm = TRUE),
.groups = "drop"
)
country_summary %>%
left_join(
scenario_flagged %>% select(UserCountry3, categories),
by = "country"
) %>%
group_by(categories) %>%
summarise(
n = n(),
mean_against = mean(prop_against, na.rm = TRUE),
sd_against = sd(prop_against, na.rm = TRUE),
median_against = median(prop_against, na.rm = TRUE),
iqr_against = IQR(prop_against, na.rm = TRUE),
.groups = "drop"
)
country_summary %>% group_by(scenario_flagged$categories) %>% summarise( n = n(), mean_against = mean(prop_against, na.rm = TRUE), sd_against = sd(prop_against, na.rm = TRUE), median_against = median(prop_against, na.rm = TRUE), iqr_against = IQR(prop_against, na.rm = TRUE), .groups = "drop" )
country_summary %>%
group_by(scenario_flagged$categories) %>%
summarise( n = n(), mean_against = mean(prop_against, na.rm = TRUE), sd_against = sd(prop_against, na.rm = TRUE), median_against = median(prop_against, na.rm = TRUE), iqr_against = IQR(prop_against, na.rm = TRUE), .groups = "drop" )
View(scenario_flagged)
View(scenario_flagged)
table(scenario_flagged$ScenarioTypeStrict,
scenario_flagged$against_majority)
chisq.test(
table(scenario_flagged$ScenarioTypeStrict,
scenario_flagged$against_majority)
)
wls_fit <- lm(prop_against ~ categories, data = country_summary, weights = n)
country_summary <- country_summary %>%
left_join(culture, by = c("UserCountry3" = "countries"))
wls_fit <- lm(prop_against ~ categories, data = country_summary, weights = n)
summary(wls_fit)
df_sample <- readRDS("df_sample.rds")
library(dplyr)
df_sample %>%
count(ResponseID, UserID) %>%
count(n) %>%
print(n = 50)
setwd("~/Documents/GitHub/Research-Report-1")
setwd("~/Documents/GitHub/Research-Report-1")
